defaults: &defaults
  provider: aws
  account: dev
  profile: dev
  providerVars:   # YAML files under here will be recursively merged. Used to configure
    - ../providers/    # providers. Errors will be thrown if expected dirs don't exist.
  kappVars:       # YAML files under these directories will be recursively merged
    - ../vars/         # and values passed to kapps to alter them per profile/manifest/etc.
    - ../values/
  templateDirs:
    - ../templates/    # paths to template files that can be used by kapps

aws-dev:
  <<: *defaults
  provisioner: kops
  cluster: dev1
  region: eu-west-1
  initManifests:
    - uri: ../manifests/05-pre-launch-dependencies.yaml
  manifests:
    # if no protocol is given, file:// is assumed.
    - uri: ../manifests/10-bootstrap-cluster.yaml
    - uri: ../manifests/15-core-aws.yaml
    - uri: ../manifests/20-security.yaml
    - uri: ../manifests/30-ci-cd.yaml
    - uri: ../manifests/40-wordpress-sites.yaml
      id: web
#      overrides:             # todo - support overriding values in manifests like this
#        wordpress-site2:     # to be able to change the branch being deployed per stack.
#          wp-kapp:           # Without this users will need to maintain multiple copies
#            branch: 1.0.2    # of manifests to control which versions are in each env
                              # (dev/staging/prod). But, how will we deal with rolling out
                              # a new kapp for the first time? Have an 'enabled' flag and
                              # disable it in prod?
